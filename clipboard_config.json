[
  {
    "text": "    def focus_listbox_last(self, event):\r\n        \"\"\"Move focus to listbox and select last item\"\"\"\r\n        if self.listbox.size() > 0:\r\n            self.listbox.focus_set()\r\n            self.listbox.selection_clear(0, tk.END)\r\n            last_index = self.listbox.size() - 1\r\n            self.listbox.selection_set(last_index)\r\n            self.listbox.activate(last_index)\r\n            self.listbox.see(last_index)\r\n    ",
    "timestamp": "2025-12-18T06:20:59.285543",
    "preview": "    def focus_listbox_last(self, event):         \"\"\"Move focus to listbox and select last item\"\"\" "
  },
  {
    "text": "        if self.listbox.size() > 0:\r\n            self.listbox.focus_set()\r\n            self.listbox.selection_clear(0, tk.END)\r\n            last_index = self.listbox.size() - 1\r\n            self.listbox.selection_set(last_index)\r\n            self.listbox.activate(last_index)\r\n            self.listbox.see(last_index)\r\n    \r\n    def on_hover(self, event):\r\n        \"\"\"Visual feedback on hover\"\"\"\r\n        index = self.listbox.nearest(event.y)\r\n        self.listbox.selection_clear(0, tk.END)\r\n        self.listbox.selection_set(index)\r\n    \r\n    def monitor_clipboard(self):\r\n        \"\"\"Monitor clipboard for changes\"\"\"\r\n        while self.monitoring:\r\n            try:\r\n                current = pyperclip.paste()\r\n                if current and current != self.last_clipboard:\r\n                    self.add_clip(current)\r\n                    self.last_clipboard = current\r\n            except Exception as e:\r\n                print(f\"Clipboard monitoring error: {e}\")\r\n            time.sleep(0.5)\r\n    \r\n    def add_clip(self, text):\r\n        \"\"\"Add new clip to history\"\"\"\r\n        # Remove if already exists\r\n        self.clips = [c for c in self.clips if c['text'] != text]\r\n        \r\n        # Add to beginning\r\n        clip_data = {\r\n            'text': text,\r\n            'timestamp': datetime.now().isoformat(),\r\n            'preview': text[:100].replace('\\n', ' ').replace('\\r', '')\r\n        }\r\n        self.clips.insert(0, clip_data)\r\n        \r\n        # Limit size\r\n        if len(self.clips) > self.max_clips:\r\n            self.clips = self.clips[:self.max_clips]\r\n        \r\n        # Update display if window is visible\r\n        if self.root.state() == 'normal':\r\n            self.root.after(0, self.update_listbox)\r\n        \r\n        # Save periodically\r\n        self.save_clips()\r\n    \r\n    def update_listbox(self):\r\n        \"\"\"Update the listbox with clips\"\"\"\r\n        self.listbox.delete(0, tk.END)\r\n        \r\n        search_term = self.search_var.get().lower()\r\n        filtered = [c for c in self.clips if search_term in c['text'].lower()]\r\n        \r\n        for i, clip in enumerate(filtered):\r\n            preview = clip['preview']\r\n            timestamp = datetime.fromisoformat(clip['timestamp']).strftime(\"%H:%M\")\r\n            \r\n            # Add line numbers and timestamp\r\n            display = f\"  {i+1:2d}  ‚Ä¢  {timestamp}  ‚Ä¢  {preview}\"\r\n            self.listbox.insert(tk.END, display)\r\n        \r\n        self.status_label.config(\r\n            text=f\"üìä {len(self.clips)} clips stored  ‚Ä¢  {len(filtered)} shown  ‚Ä¢  Alt+V to toggle\"\r\n        )\r\n        \r\n        if filtered:\r\n            self.listbox.selection_set(0)\r\n            self.listbox.activate(0)\r\n    \r\n    def filter_clips(self, *args):\r\n        \"\"\"Filter clips based on search\"\"\"\r\n        self.update_listbox()\r\n    \r\n    def paste_selected(self, event=None):\r\n        \"\"\"Paste the selected clip\"\"\"\r\n        selection = self.listbox.curselection()\r\n        if not selection:\r\n            return\r\n        \r\n        index = selection[0]\r\n        search_term = self.search_var.get().lower()\r\n        filtered = [c for c in self.clips if search_term in c['text'].lower()]\r\n        \r\n        if index < len(filtered):\r\n            clip_text = filtered[index]['text']\r\n            pyperclip.copy(clip_text)\r\n            self.last_clipboard = clip_text\r\n            \r\n            # Hide window\r\n            self.hide_window()\r\n            \r\n            # Small delay then simulate Ctrl+V\r\n            time.sleep(0.1)\r\n            keyboard.send('ctrl+v')\r\n    \r\n    def paste_first(self, event=None):\r\n        \"\"\"Paste the first item in filtered list\"\"\"\r\n        if self.listbox.size() > 0:\r\n            self.listbox.selection_clear(0, tk.END)\r\n            self.listbox.selection_set(0)\r\n            self.paste_selected()\r\n    \r\n    def show_window(self):\r\n        \"\"\"Show the clipboard manager window\"\"\"\r\n        self.root.deiconify()\r\n        self.root.lift()\r\n        self.root.focus_force()\r\n        self.search_entry.focus_set()\r\n        self.search_var.set(\"\")  # Clear search\r\n        self.update_listbox()\r\n    \r\n    def hide_window(self):\r\n        \"\"\"Hide the window\"\"\"\r\n        self.root.withdraw()\r\n    \r\n    def save_clips(self):\r\n        \"\"\"Save clips to file\"\"\"\r\n        try:\r\n            with open(self.config_file, 'w', encoding='utf-8') as f:\r\n                json.dump(self.clips, f, ensure_ascii=False, indent=2)\r\n        except Exception as e:\r\n            print(f\"Error saving clips: {e}\")\r\n    \r\n    def load_clips(self):\r\n        \"\"\"Load clips from file\"\"\"\r\n        try:\r\n            if os.path.exists(self.config_file):\r\n                with open(self.config_file, 'r', encoding='utf-8') as f:\r\n                    self.clips = json.load(f)\r\n        except Exception as e:\r\n            print(f\"Error loading clips: {e}\")\r\n            self.clips = []\r\n    \r\n    def run(self):\r\n        \"\"\"Start the application\"\"\"\r\n        print(\"üöÄ Clipboard Manager started!\")\r\n        print(\"üìå Press Alt+V to open clipboard history\")\r\n        print(\"‚ùå Press Ctrl+C to quit\")\r\n        \r\n        try:\r\n            self.root.mainloop()\r\n        except KeyboardInterrupt:\r\n            self.monitoring = False\r\n            self.save_clips()\r\n\r\nif __name__ == \"__main__\":\r\n    app = ClipboardManager()\r\n    app.run()",
    "timestamp": "2025-12-18T06:20:36.768499",
    "preview": "        if self.listbox.size() > 0:             self.listbox.focus_set()             self.listbox."
  },
  {
    "text": "    app.run()pip install pyperclip keyboardD\r\n",
    "timestamp": "2025-12-18T06:20:13.242773",
    "preview": "    app.run()pip install pyperclip keyboardD "
  },
  {
    "text": "import tkinter as tk\r\nfrom tkinter import ttk\r\nimport pyperclip\r\nimport keyboard\r\nimport threading\r\nimport time\r\nfrom datetime import datetime\r\nimport json\r\nimport os\r\n\r\nclass ClipboardManager:\r\n    def __init__(self):\r\n        self.clips = []\r\n        self.max_clips = 500\r\n        self.monitoring = True\r\n        self.last_clipboard = \"\"\r\n        self.config_file = \"clipboard_config.json\"\r\n        \r\n        # Load previous clips\r\n        self.load_clips()\r\n        \r\n        # Create GUI\r\n        self.create_gui()\r\n        \r\n        # Start clipboard monitoring in background thread\r\n        self.monitor_thread = threading.Thread(target=self.monitor_clipboard, daemon=True)\r\n        self.monitor_thread.start()\r\n        \r\n        # Register global hotkey (Alt+V)\r\n        keyboard.add_hotkey('alt+v', self.show_window)\r\n        \r\n    def create_gui(self):\r\n        self.root = tk.Tk()\r\n        self.root.title(\"Clipboard Manager\")\r\n        self.root.geometry(\"700x500\")\r\n        self.root.withdraw()  # Start hidden\r\n        \r\n        # Modern dark theme colors\r\n        bg_color = \"#1e1e1e\"\r\n        fg_color = \"#e0e0e0\"\r\n        accent_color = \"#007acc\"\r\n        input_bg = \"#2d2d2d\"\r\n        hover_color = \"#37373d\"\r\n        \r\n        self.root.configure(bg=bg_color)\r\n        \r\n        # Header frame\r\n        header_frame = tk.Frame(self.root, bg=bg_color)\r\n        header_frame.pack(fill=tk.X, padx=20, pady=(20, 10))\r\n        \r\n        title_label = tk.Label(\r\n            header_frame, \r\n            text=\"üìã Clipboard History\", \r\n            font=(\"Segoe UI\", 16, \"bold\"),\r\n            bg=bg_color,\r\n            fg=fg_color\r\n        )\r\n        title_label.pack(anchor=tk.W)\r\n        \r\n        # Search frame\r\n        search_frame = tk.Frame(self.root, bg=bg_color)\r\n        search_frame.pack(fill=tk.X, padx=20, pady=(0, 15))\r\n        \r\n        # Search icon/label\r\n        search_label = tk.Label(\r\n            search_frame, \r\n            text=\"üîç\", \r\n            font=(\"Segoe UI\", 12),\r\n            bg=bg_color,\r\n            fg=fg_color\r\n        )\r\n        search_label.pack(side=tk.LEFT, padx=(0, 8))\r\n        \r\n        # Search entry with modern styling\r\n        self.search_var = tk.StringVar()\r\n        self.search_var.trace('w', self.filter_clips)\r\n        self.search_entry = tk.Entry(\r\n            search_frame,\r\n            textvariable=self.search_var,\r\n            font=(\"Segoe UI\", 11),\r\n            bg=input_bg,\r\n            fg=fg_color,\r\n            insertbackground=fg_color,\r\n            relief=tk.FLAT,\r\n            bd=0\r\n        )\r\n        self.search_entry.pack(side=tk.LEFT, fill=tk.X, expand=True, ipady=8, ipadx=10)\r\n        \r\n        # Add border effect to search\r\n        search_border = tk.Frame(self.root, bg=accent_color, height=2)\r\n        search_border.pack(fill=tk.X, padx=20)\r\n        \r\n        # Listbox frame\r\n        list_frame = tk.Frame(self.root, bg=bg_color)\r\n        list_frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=15)\r\n        \r\n        # Custom scrollbar\r\n        scrollbar = tk.Scrollbar(list_frame, bg=bg_color, troughcolor=bg_color)\r\n        scrollbar.pack(side=tk.RIGHT, fill=tk.Y)\r\n        \r\n        # Modern listbox\r\n        self.listbox = tk.Listbox(\r\n            list_frame,\r\n            yscrollcommand=scrollbar.set,\r\n            font=(\"Segoe UI\", 10),\r\n            bg=input_bg,\r\n            fg=fg_color,\r\n            selectbackground=accent_color,\r\n            selectforeground=\"#ffffff\",\r\n            relief=tk.FLAT,\r\n            bd=0,\r\n            highlightthickness=0,\r\n            activestyle='none'\r\n        )\r\n        self.listbox.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)\r\n        scrollbar.config(command=self.listbox.yview)\r\n        \r\n        # Status bar with modern styling\r\n        status_frame = tk.Frame(self.root, bg=hover_color)\r\n        status_frame.pack(fill=tk.X, side=tk.BOTTOM)\r\n        \r\n        self.status_label = tk.Label(\r\n            status_frame,\r\n            text=\"\",\r\n            anchor=tk.W,\r\n            font=(\"Segoe UI\", 9),\r\n            bg=hover_color,\r\n            fg=\"#a0a0a0\",\r\n            padx=20,\r\n            pady=8\r\n        )\r\n        self.status_label.pack(fill=tk.X)\r\n        \r\n        # Help text\r\n        help_frame = tk.Frame(self.root, bg=bg_color)\r\n        help_frame.pack(fill=tk.X, padx=20, pady=(0, 10))\r\n        \r\n        help_label = tk.Label(\r\n            help_frame,\r\n            text=\"‚Üµ Enter or Double-click to paste  ‚Ä¢  Esc to close  ‚Ä¢  Alt+V to open\",\r\n            font=(\"Segoe UI\", 9),\r\n            bg=bg_color,\r\n            fg=\"#707070\"\r\n        )\r\n        help_label.pack()\r\n        \r\n        # Bind events\r\n        self.listbox.bind('<Double-Button-1>', self.paste_selected)\r\n        self.listbox.bind('<Return>', self.paste_selected)\r\n        self.search_entry.bind('<Down>', self.focus_listbox)\r\n        self.search_entry.bind('<Up>', self.focus_listbox_last)\r\n        self.search_entry.bind('<Return>', self.paste_first)\r\n        self.search_entry.bind('<Escape>', lambda e: self.hide_window())\r\n        self.listbox.bind('<Escape>', lambda e: self.hide_window())\r\n        self.root.bind('<Escape>', lambda e: self.hide_window())\r\n        \r\n        # Hover effect\r\n        self.listbox.bind('<Motion>', self.on_hover)\r\n        \r\n        # Window close\r\n        self.root.protocol(\"WM_DELETE_WINDOW\", self.hide_window)\r\n        \r\n        self.update_listbox()\r\n        \r\n    def focus_listbox(self, event):\r\n        \"\"\"Move focus to listbox and select first item\"\"\"\r\n        if self.listbox.size() > 0:\r\n            self.listbox.focus_set()\r\n            self.listbox.selection_clear(0, tk.END)\r\n            self.listbox.selection_set(0)\r\n            self.listbox.activate(0)\r\n            self.listbox.see(0)\r\n    \r\n    def focus_listbox_last(self, event):\r\n        \"\"\"Move focus to listbox and select last item\"\"\"\r\n        if self.listbox.size() > 0:\r\n            self.listbox.focus_set()\r\n            self.listbox.selection_clear(0, tk.END)\r\n            last_index = self.listbox.size() - 1\r\n            self.listbox.selection_set(last_index)\r\n            self.listbox.activate(last_index)\r\n            self.listbox.see(last_index)\r\n    \r\n    def on_hover(self, event):\r\n        \"\"\"Visual feedback on hover\"\"\"\r\n        index = self.listbox.nearest(event.y)\r\n        self.listbox.selection_clear(0, tk.END)\r\n        self.listbox.selection_set(index)\r\n    \r\n    def monitor_clipboard(self):\r\n        \"\"\"Monitor clipboard for changes\"\"\"\r\n        while self.monitoring:\r\n            try:\r\n                current = pyperclip.paste()\r\n                if current and current != self.last_clipboard:\r\n                    self.add_clip(current)\r\n                    self.last_clipboard = current\r\n            except Exception as e:\r\n                print(f\"Clipboard monitoring error: {e}\")\r\n            time.sleep(0.5)\r\n    \r\n    def add_clip(self, text):\r\n        \"\"\"Add new clip to history\"\"\"\r\n        # Remove if already exists\r\n        self.clips = [c for c in self.clips if c['text'] != text]\r\n        \r\n        # Add to beginning\r\n        clip_data = {\r\n            'text': text,\r\n            'timestamp': datetime.now().isoformat(),\r\n            'preview': text[:100].replace('\\n', ' ').replace('\\r', '')\r\n        }\r\n        self.clips.insert(0, clip_data)\r\n        \r\n        # Limit size\r\n        if len(self.clips) > self.max_clips:\r\n            self.clips = self.clips[:self.max_clips]\r\n        \r\n        # Update display if window is visible\r\n        if self.root.state() == 'normal':\r\n            self.root.after(0, self.update_listbox)\r\n        \r\n        # Save periodically\r\n        self.save_clips()\r\n    \r\n    def update_listbox(self):\r\n        \"\"\"Update the listbox with clips\"\"\"\r\n        self.listbox.delete(0, tk.END)\r\n        \r\n        search_term = self.search_var.get().lower()\r\n        filtered = [c for c in self.clips if search_term in c['text'].lower()]\r\n        \r\n        for i, clip in enumerate(filtered):\r\n            preview = clip['preview']\r\n            timestamp = datetime.fromisoformat(clip['timestamp']).strftime(\"%H:%M\")\r\n            \r\n            # Add line numbers and timestamp\r\n            display = f\"  {i+1:2d}  ‚Ä¢  {timestamp}  ‚Ä¢  {preview}\"\r\n            self.listbox.insert(tk.END, display)\r\n        \r\n        self.status_label.config(\r\n            text=f\"üìä {len(self.clips)} clips stored  ‚Ä¢  {len(filtered)} shown  ‚Ä¢  Alt+V to toggle\"\r\n        )\r\n        \r\n        if filtered:\r\n            self.listbox.selection_set(0)\r\n            self.listbox.activate(0)\r\n    \r\n    def filter_clips(self, *args):\r\n        \"\"\"Filter clips based on search\"\"\"\r\n        self.update_listbox()\r\n    \r\n    def paste_selected(self, event=None):\r\n        \"\"\"Paste the selected clip\"\"\"\r\n        selection = self.listbox.curselection()\r\n        if not selection:\r\n            return\r\n        \r\n        index = selection[0]\r\n        search_term = self.search_var.get().lower()\r\n        filtered = [c for c in self.clips if search_term in c['text'].lower()]\r\n        \r\n        if index < len(filtered):\r\n            clip_text = filtered[index]['text']\r\n            pyperclip.copy(clip_text)\r\n            self.last_clipboard = clip_text\r\n            \r\n            # Hide window\r\n            self.hide_window()\r\n            \r\n            # Small delay then simulate Ctrl+V\r\n            time.sleep(0.1)\r\n            keyboard.send('ctrl+v')\r\n    \r\n    def paste_first(self, event=None):\r\n        \"\"\"Paste the first item in filtered list\"\"\"\r\n        if self.listbox.size() > 0:\r\n            self.listbox.selection_clear(0, tk.END)\r\n            self.listbox.selection_set(0)\r\n            self.paste_selected()\r\n    \r\n    def show_window(self):\r\n        \"\"\"Show the clipboard manager window\"\"\"\r\n        self.root.deiconify()\r\n        self.root.lift()\r\n        self.root.focus_force()\r\n        self.search_entry.focus_set()\r\n        self.search_var.set(\"\")  # Clear search\r\n        self.update_listbox()\r\n    \r\n    def hide_window(self):\r\n        \"\"\"Hide the window\"\"\"\r\n        self.root.withdraw()\r\n    \r\n    def save_clips(self):\r\n        \"\"\"Save clips to file\"\"\"\r\n        try:\r\n            with open(self.config_file, 'w', encoding='utf-8') as f:\r\n                json.dump(self.clips, f, ensure_ascii=False, indent=2)\r\n        except Exception as e:\r\n            print(f\"Error saving clips: {e}\")\r\n    \r\n    def load_clips(self):\r\n        \"\"\"Load clips from file\"\"\"\r\n        try:\r\n            if os.path.exists(self.config_file):\r\n                with open(self.config_file, 'r', encoding='utf-8') as f:\r\n                    self.clips = json.load(f)\r\n        except Exception as e:\r\n            print(f\"Error loading clips: {e}\")\r\n            self.clips = []\r\n    \r\n    def run(self):\r\n        \"\"\"Start the application\"\"\"\r\n        print(\"üöÄ Clipboard Manager started!\")\r\n        print(\"üìå Press Alt+V to open clipboard history\")\r\n        print(\"‚ùå Press Ctrl+C to quit\")\r\n        \r\n        try:\r\n            self.root.mainloop()\r\n        except KeyboardInterrupt:\r\n            self.monitoring = False\r\n            self.save_clips()\r\n\r\nif __name__ == \"__main__\":\r\n    app = ClipboardManager()\r\n    app.run()",
    "timestamp": "2025-12-18T06:19:58.091527",
    "preview": "import tkinter as tk from tkinter import ttk import pyperclip import keyboard import threading "
  },
  {
    "text": "        try:\r\n            with open(self.config_file, 'w', encoding='utf-8') as f:\r\n                json.dump(self.clips, f, ensure_ascii=False, indent=2)\r\n        except Exception as e:\r\n            print(f\"Error saving clips: {e}\")\r\n    \r\n    def load_clips(self):\r\n        \"\"\"Load clips from file\"\"\"",
    "timestamp": "2025-12-18T06:16:06.176248",
    "preview": "        try:             with open(self.config_file, 'w', encoding='utf-8') as f:                 "
  },
  {
    "text": "pip install pyperclip keyboard",
    "timestamp": "2025-12-18T06:15:27.041974",
    "preview": "pip install pyperclip keyboard"
  }
]